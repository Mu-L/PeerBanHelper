const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./dummyChart-D6hncPx0.js","./echarts-bYoUNm06.js","./libs-Dj0SilfQ.js","./index-B2eIo-gP.js","./arcoDesign-R_OFWu-B.js","./uuid-BMzgKRou.js","./index-DZLXUQhT.css"])))=>i.map(i=>d[i]);
import{u as F,a as J,g as X,q as G,r as he,_ as ye,f as ce,s as be}from"./index-B2eIo-gP.js";import{a as D,C as z,ap as q,f as $,aa as K,L as re,H as Q,J as Y,K as ue,O as fe,aA as ne,S as le,w as me,T as ge,E as ve,e as ke,aB as we,U as De,R as xe,W as Se,ay as Ve,aC as Ce,V as Oe}from"./arcoDesign-R_OFWu-B.js";import{u as Z,E as ee,i as te,a as de,b as _e,c as ae,d as ie,e as pe,f as Te}from"./echarts-bYoUNm06.js";import{f as I,a7 as E,a as T,r as oe,c as V,w as M,aa as N,s as h,k as _,a3 as e,t,y as n,v as m,x as g,u as j,l as Pe,ab as Ae,j as Ue,P as Le,F as Re}from"./libs-Dj0SilfQ.js";import{I as Ie}from"./index-DESYekPG.js";import{u as Ee}from"./userStore-f2R6aaLf.js";import"./uuid-BMzgKRou.js";async function $e(y,a=!1,s){const o=F();await o.serverAvailable;const r=new URLSearchParams({type:"count",field:y,filter:a?"0.01":"0"});s&&r.append("downloader",s);const f=new URL(J(o.endpoint,"api/statistic/analysis/field?"+r.toString()),location.href);return fetch(f,{headers:X()}).then(p=>(o.assertResponseLogin(p),p.json()))}async function Be(y,a,s,o){const r=F();await r.serverAvailable;const f=new URL(J(r.endpoint,"api/chart/geoIpInfo"),location.href),p=y.getTime(),u=a.getTime();return f.searchParams.append("startAt",p.toString()),f.searchParams.append("endAt",u.toString()),f.searchParams.append("bannedOnly",String(s)),o&&f.searchParams.append("downloader",o),fetch(f,{headers:X()}).then(b=>(r.assertResponseLogin(b),b.json()))}async function je(y,a,s){const o=F();await o.serverAvailable;const r=new URLSearchParams({startAt:y.getTime().toString(),endAt:a.getTime().toString()});s&&r.append("downloader",s);const f=new URL(J(o.endpoint,"api/statistic/analysis/banTrends?"+r.toString()),location.href);return fetch(f,{headers:X()}).then(p=>(o.assertResponseLogin(p),p.json()))}async function Fe(y,a,s){const o=F();await o.serverAvailable;const r=new URLSearchParams({startAt:y.getTime().toString(),endAt:a.getTime().toString()});s&&r.append("downloader",s);const f=new URL(J(o.endpoint,"api/chart/trend?"+r.toString()),location.href);return fetch(f,{headers:X()}).then(p=>(o.assertResponseLogin(p),p.json()))}async function ze(y,a,s){const o=F();await o.serverAvailable;const r=new URLSearchParams({startAt:y.getTime().toString(),endAt:a.getTime().toString()});s&&r.append("downloader",s);const f=new URL(J(o.endpoint,"api/chart/traffic?"+r.toString()),location.href);return fetch(f,{headers:X()}).then(p=>(o.assertResponseLogin(p),p.json()))}const qe=I({__name:"ispPie",props:{downloader:{}},setup(y){const{t:a}=E();Z([te,de,_e,ae]);const s=G(),o=T(),r=oe({field:"isp",enableThreshold:!0,bannedOnly:!0,range:[D().startOf("day").add(-14,"day").toDate(),new Date]}),f=V(()=>({text:a("page.charts.loading"),color:s.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:s.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:s.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),p=V(()=>({tooltip:{trigger:"item",appendToBody:!0,formatter:'<p style="word-wrap:break-all"><b>{b}</b></p>  {c} ({d}%)',backgroundColor:s.isDark?"#333335":"#ffffff",borderColor:s.isDark?"#333335":"#ffffff",textStyle:{color:s.isDark?"rgba(255, 255, 255, 0.7)":void 0}},backgroundColor:s.isDark?"rgba(0, 0, 0, 0.0)":void 0,...u.value})),u=T({legend:{orient:"vertical",left:"right",type:"scroll",right:10,top:20,bottom:20,data:[],textStyle:{overflow:"truncate",width:100},tooltip:{show:!0}},series:[{name:"",type:"pie",radius:"55%",center:["50%","60%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});M(r,c=>{w(c.range[0],c.range[1],r.bannedOnly,b.downloader)});const b=y,{loading:x,run:w,refresh:C}=N(Be,{defaultParams:[r.range[0],r.range[1],r.bannedOnly,b.downloader],onSuccess:c=>{if(c.data){const l=c.data[r.field];let d;if(r.enableThreshold){const v=l.reduce((k,O)=>k+O.value,0)*.01;d=l.filter(k=>k.value>=v)}else d=l;u.value.legend.data=d.map(i=>i.key),u.value.series[0].data=d.map(i=>({name:i.key==="N/A"&&r.field==="province"?a("page.charts.data.province.na"):i.key,value:i.value})),u.value.series[0].name=a("page.charts.options.field."+r.field)}},onError:c=>{o.value=c}});return(c,l)=>{const d=$,i=q,v=re,k=fe,O=ue,S=Y,P=ne,A=me,U=ge,B=le,W=Q,H=K,L=z;return _(),h(L,{hoverable:"",title:e(a)("page.charts.title.geoip")+(r.bannedOnly?e(a)("page.charts.subtitle.bannedOnly"):"")},{extra:t(()=>[n(H,null,{content:t(()=>[n(W,{model:r},{default:t(()=>[n(S,{field:"field",label:e(a)("page.charts.options.field")},{default:t(()=>[n(O,{modelValue:r.field,"onUpdate:modelValue":l[1]||(l[1]=R=>r.field=R),"trigger-props":{autoFitPopupMinWidth:!0}},{default:t(()=>[n(k,{value:"isp"},{default:t(()=>[m(g(e(a)("page.charts.options.field.isp")),1)]),_:1}),n(k,{value:"province"},{default:t(()=>[m(g(e(a)("page.charts.options.field.province")),1)]),_:1}),n(k,{value:"city"},{default:t(()=>[m(g(e(a)("page.charts.options.field.city")),1)]),_:1}),n(k,{value:"region"},{default:t(()=>[m(g(e(a)("page.charts.options.field.region")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(S,{field:"range",label:e(a)("page.charts.options.days")},{default:t(()=>[n(P,{modelValue:r.range,"onUpdate:modelValue":l[2]||(l[2]=R=>r.range=R),"show-time":"","value-format":"Date",shortcuts:[{label:e(a)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(a)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(a)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"]),n(S,{field:"enableThreshold"},{default:t(()=>[n(B,null,{default:t(()=>[n(A,{modelValue:r.enableThreshold,"onUpdate:modelValue":l[3]||(l[3]=R=>r.enableThreshold=R)},null,8,["modelValue"]),n(U,null,{default:t(()=>[m(g(e(a)("page.charts.options.thresold")),1)]),_:1})]),_:1})]),_:1}),n(S,{field:"bannedOnly"},{default:t(()=>[n(B,null,{default:t(()=>[n(A,{modelValue:r.bannedOnly,"onUpdate:modelValue":l[4]||(l[4]=R=>r.bannedOnly=R)},null,8,["modelValue"]),n(U,null,{default:t(()=>[m(g(e(a)("page.charts.options.bannedOnly")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),default:t(()=>[n(v,null,{default:t(()=>[m(g(e(a)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:t(()=>[o.value?(_(),h(i,{key:0,status:"500",title:e(a)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(o.value.message),1)]),extra:t(()=>[n(d,{type:"primary",onClick:l[0]||(l[0]=()=>{o.value=void 0,e(C)()})},{default:t(()=>[m(g(e(a)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),h(e(ee),{key:1,class:"chart",option:p.value,loading:e(x),autoresize:"","loading-options":f.value,theme:e(s).isDark?"dark":"light","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),Me=I({__name:"banTrends",props:{downloader:{}},setup(y){const{t:a}=E(),s=V(()=>({text:a("page.charts.loading"),color:o.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:o.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:o.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),o=G(),r=T();Z([te,ie,pe,ae]);const f=y,p=oe({range:[D().startOf("day").add(-7,"day").toDate(),new Date]}),u=V(()=>({tooltip:{trigger:"axis",backgroundColor:o.isDark?"#333335":"#ffffff",borderColor:o.isDark?"#333335":"#ffffff",textStyle:{color:o.isDark?"rgba(255, 255, 255, 0.7)":void 0}},backgroundColor:o.isDark?"rgba(0, 0, 0, 0.0)":void 0,...b.value})),b=T({xAxis:{type:"time",max:"dataMax"},yAxis:{type:"value"},grid:{left:"15%"},series:[{data:[],type:"line",name:a("page.charts.line.options.field")}]});M(p,c=>{w(c.range[0],c.range[1],f.downloader)});const{loading:x,run:w,refresh:C}=N(je,{defaultParams:[D().startOf("day").add(-7,"day").toDate(),new Date,f.downloader],onSuccess:c=>{c.data&&(b.value.series[0].data=c.data.sort((l,d)=>l.key-d.key).map(l=>[new Date(l.key),l.value]))},onError:c=>{r.value=c}});return(c,l)=>{const d=re,i=ne,v=Y,k=Q,O=K,S=$,P=q,A=z;return _(),h(A,{hoverable:"",title:e(a)("page.charts.title.line")},{extra:t(()=>[n(O,null,{content:t(()=>[n(k,{model:p},{default:t(()=>[n(v,{field:"range",label:e(a)("page.charts.options.days"),"label-col-flex":"100px"},{default:t(()=>[n(i,{modelValue:p.range,"onUpdate:modelValue":l[0]||(l[0]=U=>p.range=U),"show-time":"","value-format":"Date",shortcuts:[{label:e(a)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(a)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(a)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:t(()=>[n(d,null,{default:t(()=>[m(g(e(a)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:t(()=>[r.value?(_(),h(P,{key:0,status:"500",title:e(a)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(r.value.message),1)]),extra:t(()=>[n(S,{type:"primary",onClick:l[1]||(l[1]=()=>{r.value=void 0,e(C)()})},{default:t(()=>[m(g(e(a)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),h(e(ee),{key:1,class:"chart",option:u.value,loading:e(x),"loading-options":s.value,theme:e(o).isDark?"dark":"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),Ne=I({__name:"fieldPie",props:{downloader:{}},setup(y){const{t:a}=E();Z([te,de,_e,ae]);const s=G(),o=oe({field:"peerId",enableThreshold:!0,mergeSameVersion:!1}),r=V(()=>({text:a("page.charts.loading"),color:s.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:s.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:s.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),f=T(),p=V(()=>({tooltip:{trigger:"item",appendToBody:!0,formatter:'<p style="word-wrap:break-all"><b>{b}</b></p>  {c} ({d}%)',backgroundColor:s.isDark?"#333335":"#ffffff",borderColor:s.isDark?"#333335":"#ffffff",textStyle:{color:s.isDark?"rgba(255, 255, 255, 0.7)":void 0}},backgroundColor:s.isDark?"rgba(0, 0, 0, 0.0)":void 0,...u.value})),u=T({legend:{orient:"vertical",left:"right",type:"scroll",right:10,top:20,bottom:20,data:[],textStyle:{overflow:"truncate",width:100},tooltip:{show:!0}},series:[{name:a("page.charts.options.field."+o.field),type:"pie",radius:"55%",center:["50%","60%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});M(o,c=>{w(c.field,c.enableThreshold,b.downloader)});const b=y,{loading:x,run:w,refresh:C}=N($e,{defaultParams:["peerId",!0,b.downloader],onSuccess:c=>{if(c.data){const l=c.data.map(d=>(d.data===""&&(d.data=a("page.charts.options.field.empty")),d));if(o.mergeSameVersion&&o.field==="peerId"){const d=new Map;l.forEach(i=>{let v=i.data;const k=v.match(/^([-]?[a-zA-z]+)[0-9]+.*/);k&&k?.length>=2&&(v=k[1]+"*"),d.has(v)?d.set(v,d.get(v)+i.count):d.set(v,i.count)}),u.value.legend.data=[],u.value.series[0].data=[],Array.from(d).forEach(([i,v])=>{u.value.legend.data.push(i),u.value.series[0].data.push({name:i,value:v})})}else u.value.legend.data=l.map(d=>d.data),u.value.series[0].data=l.map(d=>({name:d.data,value:d.count}))}},onError:c=>{f.value=c}});return(c,l)=>{const d=$,i=q,v=re,k=fe,O=ue,S=Y,P=me,A=ge,U=le,B=Q,W=K,H=z;return _(),h(H,{hoverable:"",title:e(a)("page.charts.options.field."+o.field)},{extra:t(()=>[n(W,null,{content:t(()=>[n(B,{model:o,style:{width:"25vh"}},{default:t(()=>[n(S,{field:"field",label:e(a)("page.charts.options.field")},{default:t(()=>[n(O,{modelValue:o.field,"onUpdate:modelValue":l[1]||(l[1]=L=>o.field=L),"trigger-props":{autoFitPopupMinWidth:!0}},{default:t(()=>[n(k,{value:"peerId"},{default:t(()=>[m(g(e(a)("page.charts.options.field.peerId")),1)]),_:1}),n(k,{value:"torrentName"},{default:t(()=>[m(g(e(a)("page.charts.options.field.torrentName")),1)]),_:1}),n(k,{value:"module"},{default:t(()=>[m(g(e(a)("page.charts.options.field.module")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),n(S,{field:"enableThreshold"},{default:t(()=>[n(U,null,{default:t(()=>[n(P,{modelValue:o.enableThreshold,"onUpdate:modelValue":l[2]||(l[2]=L=>o.enableThreshold=L)},null,8,["modelValue"]),n(A,null,{default:t(()=>[m(g(e(a)("page.charts.options.thresold")),1)]),_:1})]),_:1})]),_:1}),o.field==="peerId"?(_(),h(S,{key:0,field:"mergeSameVersion"},{default:t(()=>[n(U,null,{default:t(()=>[n(P,{modelValue:o.mergeSameVersion,"onUpdate:modelValue":l[3]||(l[3]=L=>o.mergeSameVersion=L)},null,8,["modelValue"]),n(A,null,{default:t(()=>[m(g(e(a)("page.charts.options.mergeSame")),1)]),_:1})]),_:1})]),_:1})):j("",!0)]),_:1},8,["model"])]),default:t(()=>[n(v,null,{default:t(()=>[m(g(e(a)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:t(()=>[f.value?(_(),h(i,{key:0,status:"500",title:e(a)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(f.value.message),1)]),extra:t(()=>[n(d,{type:"primary",onClick:l[0]||(l[0]=()=>{f.value=void 0,e(C)()})},{default:t(()=>[m(g(e(a)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),h(e(ee),{key:1,class:"chart",option:p.value,loading:e(x),autoresize:"","loading-options":r.value,theme:e(s).isDark?"dark":"light","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),We=I({__name:"plusWarpper",props:{title:{}},setup(y){const a=Ae(()=>he(()=>import("./dummyChart-D6hncPx0.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)),{t:s}=E(),o=F(),r=()=>{o.emitter.emit("open-plus-modal")};return(f,p)=>{const u=Ie,b=$,x=q,w=z;return e(o).plusStatus?.enabledFeatures?.includes("basic")&&e(o).plusStatus?.enabledFeatures?.includes("paid")?Pe(f.$slots,"default",{key:0},void 0,!0):(_(),h(w,{key:1,hoverable:"",title:f.title},{default:t(()=>[n(x,{class:"overlay",status:"warning",title:e(s)("page.charts.locked")},{icon:t(()=>[n(u)]),subtitle:t(()=>[m(g(e(s)("page.charts.locked.tips")),1)]),extra:t(()=>[n(b,{type:"primary",onClick:r},{default:t(()=>[m(g(e(s)("page.charts.locked.active")),1)]),_:1})]),_:1},8,["title"]),n(e(a))]),_:1},8,["title"]))}}}),se=ye(We,[["__scopeId","data-v-a3d407ad"]]),He=I({__name:"traffic",props:{downloader:{}},setup(y){Z([te,de,Te,pe,ie,ae]);const a=oe({range:[D().startOf("day").add(-14,"day").toDate(),new Date]}),s=G(),o=V(()=>({text:r("page.charts.loading"),color:s.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:s.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:s.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),{t:r,d:f}=E(),p=T(),u=V(()=>({tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:s.isDark?"#333335":"#ffffff",borderColor:s.isDark?"#333335":"#ffffff",textStyle:{color:s.isDark?"rgba(255, 255, 255, 0.7)":void 0},formatter:function(d){return f(d[0].data[0],"short")+":<br/>"+d.map(i=>`${i.marker} ${i.seriesName}: ${ce(i.data[1])}`).join("<br>")}},backgroundColor:s.isDark?"rgba(0, 0, 0, 0.0)":void 0,...b.value})),b=T({legend:{data:[r("page.charts.traffic.options.download"),r("page.charts.traffic.options.upload")]},xAxis:{type:"time",max:"dataMax",min:"dataMin",minInterval:3600*24*1e3},grid:{left:"15%"},yAxis:{type:"value",axisLabel:{formatter:d=>ce(d)}},series:[{name:r("page.charts.traffic.options.download"),type:"line",emphasis:{focus:"series"},data:[]},{name:r("page.charts.traffic.options.upload"),type:"line",emphasis:{focus:"series"},data:[]}]});M(a,d=>{C(d.range[0],d.range[1],x.downloader)});const x=y,{loading:w,run:C,refresh:c,data:l}=N(ze,{defaultParams:[a.range[0],a.range[1],x.downloader],onSuccess:d=>{d.data&&(b.value.series[0].data=d.data.map(i=>[new Date(i.timestamp),i.dataOverallDownloaded]),b.value.series[1].data=d.data.map(i=>[new Date(i.timestamp),i.dataOverallUploaded]))},onError:d=>{p.value=d}});return(d,i)=>{const v=re,k=ne,O=Y,S=Q,P=we,A=ke,U=K,B=$,W=q,H=ve,L=z;return _(),h(L,{hoverable:"",title:e(r)("page.charts.title.traffic")},{extra:t(()=>[n(U,null,{content:t(()=>[n(S,{model:a},{default:t(()=>[n(O,{field:"range",label:e(r)("page.charts.options.days"),"label-col-flex":"100px"},{default:t(()=>[n(k,{modelValue:a.range,"onUpdate:modelValue":i[0]||(i[0]=R=>a.range=R),"show-time":"","value-format":"Date",shortcuts:[{label:e(r)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(r)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(r)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:t(()=>[n(v,null,{default:t(()=>[m(g(e(r)("page.charts.options.more")),1)]),_:1}),n(A,{content:e(r)("page.charts.tooltip.traffic")},{default:t(()=>[n(P)]),_:1},8,["content"])]),_:1})]),default:t(()=>[p.value?(_(),h(W,{key:0,status:"500",title:e(r)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(p.value.message),1)]),extra:t(()=>[n(B,{type:"primary",onClick:i[1]||(i[1]=()=>{p.value=void 0,e(c)()})},{default:t(()=>[m(g(e(r)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):!e(l)?.data&&!e(w)?(_(),h(H,{key:1,class:"chart",style:{"align-items":"center",display:"flex","justify-content":"center","flex-direction":"column"}})):(_(),h(e(ee),{key:2,class:"chart",option:u.value,loading:e(w),"loading-options":o.value,theme:e(s).isDark?"dark":"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),Je=I({__name:"trends",props:{downloader:{}},setup(y){Z([pe,te,ie,ae]);const{t:a}=E(),s=oe({range:[D().startOf("day").add(-14,"day").toDate(),new Date]}),o=T(),r=G(),f=V(()=>({text:a("page.charts.loading"),color:r.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:r.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:r.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),p=V(()=>({tooltip:{trigger:"axis",backgroundColor:r.isDark?"#333335":"#ffffff",borderColor:r.isDark?"#333335":"#ffffff",textStyle:{color:r.isDark?"rgba(255, 255, 255, 0.7)":""}},backgroundColor:r.isDark?"rgba(0, 0, 0, 0.0)":void 0,...u.value})),u=T({xAxis:{type:"time",max:"dataMax"},yAxis:{type:"value"},series:[{data:[],type:"line",color:"#A5A051",areaStyle:{color:"#A5A051"},name:a("page.charts.trends.options.peers")},{data:[],type:"line",color:"#DB4D6D",areaStyle:{color:"#DB4D6D"},name:a("page.charts.trends.options.bans")}]});M(s,c=>{w(c.range[0],c.range[1],b.downloader)});const b=y,{loading:x,run:w,refresh:C}=N(Fe,{defaultParams:[s.range[0],s.range[1],b.downloader],onSuccess:c=>{c.data&&(u.value.series[0].data=c.data.connectedPeersTrend.sort((l,d)=>l.key-d.key).map(l=>[new Date(l.key),l.value]),u.value.series[1].data=c.data.bannedPeersTrend.sort((l,d)=>l.key-d.key).map(l=>[new Date(l.key),l.value]))},onError:c=>{o.value=c}});return(c,l)=>{const d=ne,i=Y,v=Q,k=$,O=q,S=z;return _(),h(S,{hoverable:"",title:e(a)("page.charts.title.trends")},{extra:t(()=>[n(v,{model:s,"auto-label-width":""},{default:t(()=>[n(i,{field:"range",label:e(a)("page.charts.options.days"),style:{"margin-bottom":"0"}},{default:t(()=>[n(d,{modelValue:s.range,"onUpdate:modelValue":l[0]||(l[0]=P=>s.range=P),"value-format":"Date",style:{width:"275px"},shortcuts:[{label:e(a)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(a)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(a)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:t(()=>[o.value?(_(),h(O,{key:0,status:"500",title:e(a)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(o.value.message),1)]),extra:t(()=>[n(k,{type:"primary",onClick:l[1]||(l[1]=()=>{o.value=void 0,e(C)()})},{default:t(()=>[m(g(e(a)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(_(),h(e(ee),{key:1,class:"chart",option:p.value,loading:e(x),"loading-options":f.value,theme:e(r).isDark?"dark":"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),Xe=I({__name:"grid",props:{downloader:{},showCharts:{}},setup(y){const{t:a}=E(),s=y,o=V(()=>s.downloader==="all"?void 0:s.downloader);return(r,f)=>{const p=xe,u=De;return _(),h(u,{justify:"center",align:"stretch",wrap:!0,gutter:[{xs:12,sm:12,md:12,lg:12,xl:24},{xs:12,sm:12,md:12,lg:12,xl:24}]},{default:t(()=>[r.showCharts.banTrends?(_(),h(p,{key:0,xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[n(Me,{downloader:o.value},null,8,["downloader"])]),_:1})):j("",!0),r.showCharts.fieldPie?(_(),h(p,{key:1,xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[n(Ne,{downloader:o.value},null,8,["downloader"])]),_:1})):j("",!0),r.showCharts.ispPie?(_(),h(p,{key:2,xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[n(se,{title:e(a)("page.charts.title.geoip")},{default:t(()=>[n(qe,{downloader:o.value},null,8,["downloader"])]),_:1},8,["title"])]),_:1})):j("",!0),r.showCharts.traffic?(_(),h(p,{key:3,xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[n(se,{title:e(a)("page.charts.title.traffic")},{default:t(()=>[n(He,{downloader:o.value},null,8,["downloader"])]),_:1},8,["title"])]),_:1})):j("",!0),r.showCharts.trends?(_(),h(p,{key:4,xl:24,lg:24,md:24,sm:24,xs:24},{default:t(()=>[n(se,{title:e(a)("page.charts.title.trends")},{default:t(()=>[n(Je,{downloader:o.value},null,8,["downloader"])]),_:1},8,["title"])]),_:1})):j("",!0)]),_:1})}}}),at=I({__name:"index",setup(y){const{t:a}=E(),s=Ee(),o=T(s.showCharts),{data:r}=N(be);M(o,()=>{s.setShowCharts(o.value)});const f=V(()=>[{id:"all",title:a("page.charts.all")},...r.value?.data.map(p=>({id:p.id,title:p.name}))??[]]);return(p,u)=>{const b=Ve,x=$,w=Ce,C=le,c=K,l=Oe,d=Se;return _(),h(d,{"default-active-key":0,"lazy-load":"",animation:"",type:"rounded"},{extra:t(()=>[n(c,{position:"bottom"},{content:t(()=>[n(C,{direction:"vertical"},{default:t(()=>[n(w,{modelValue:o.value.banTrends,"onUpdate:modelValue":u[0]||(u[0]=i=>o.value.banTrends=i)},{default:t(()=>[m(g(e(a)("page.charts.title.line")),1)]),_:1},8,["modelValue"]),n(w,{modelValue:o.value.fieldPie,"onUpdate:modelValue":u[1]||(u[1]=i=>o.value.fieldPie=i)},{default:t(()=>[m(g(e(a)("page.charts.title.fieldPie")),1)]),_:1},8,["modelValue"]),n(w,{modelValue:o.value.ispPie,"onUpdate:modelValue":u[2]||(u[2]=i=>o.value.ispPie=i)},{default:t(()=>[m(g(e(a)("page.charts.title.geoip")),1)]),_:1},8,["modelValue"]),n(w,{modelValue:o.value.traffic,"onUpdate:modelValue":u[3]||(u[3]=i=>o.value.traffic=i)},{default:t(()=>[m(g(e(a)("page.charts.title.traffic")),1)]),_:1},8,["modelValue"]),n(w,{modelValue:o.value.trends,"onUpdate:modelValue":u[4]||(u[4]=i=>o.value.trends=i)},{default:t(()=>[m(g(e(a)("page.charts.title.trends")),1)]),_:1},8,["modelValue"])]),_:1})]),default:t(()=>[n(x,null,{icon:t(()=>[n(b)]),default:t(()=>[m(g(e(a)("page.charts.options")),1)]),_:1})]),_:1})]),default:t(()=>[(_(!0),Ue(Re,null,Le(f.value,(i,v)=>(_(),h(l,{key:v,title:i.title},{default:t(()=>[n(Xe,{downloader:i.id,"show-charts":o.value},null,8,["downloader","show-charts"])]),_:2},1032,["title"]))),128))]),_:1})}}});export{at as default};
